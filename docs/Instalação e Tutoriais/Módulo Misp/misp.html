<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tutorial de Instalação do Kytos</title>
    <link rel="stylesheet" href="misp.css">
</head>
<body>

    <header>
        <div class="logo-group">
            <div class="logo">
                <img src="imagens/logo.PNG" alt="HackInSDN Logo">
            </div>
        </div>
        <nav>
            <ul>
                <li><a href="index.html">Home</a></li>
                <li><a href="quem-somos.html">Quem Somos</a></li>
                <li><a href="tutoriais.html">Tutoriais</a></li>
                <li><a href="publicacoes.html">Publicações</a></li>
                <li><a href="https://dashboard.hackinsdn.ufba.br/login/" target="_blank">Portal</a></li>

            </ul>
        </nav>
    </header>

    <div class="container">

        <section class="tutorial-content">
            <h1>TUTORIAL DO MÓDULO MISP</h1>
            <h2>Instalação do MISP Threat Sharing (MISP)</h2>
            <p>Este tutorial é baseado nas instruções do site oficial do MISP (<a href="https://misp-project.org/" target="_blank">https://misp-project.org/</a>). O projeto HackInSDN utiliza a solução de containers Docker, com imagens mantidas por Stefano Ortolani da VMware, que são atualizadas regularmente no repositório GitHub do MISP. Acesse a documentação do MISP para ter acesso às opções de instalação. As instruções para a instalação usando as imagens mantidas por Stefano Ortolani da VMware podem ser acessadas em: <a href="https://github.com/MISP/misp-docker" target="_blank">https://github.com/MISP/misp-docker</a>.</p>
            <p>Requisitos mínimos para implementar uma instância MISP:</p>
            <ul>
                <li>Uma máquina virtual Linux (preferencialmente com as distribuições Debian 12 ou Ubuntu 24.04 LTS) com:</li>
                <li>1 processador</li>
                <li>4 GB de RAM</li>
                <li>80GB de disco</li>
                <li>Versão mais recente do Docker Desktop e/ou Docker Engine.</li>
            </ul>
            
            <div class="step">
                <h3>Passos para a instalação:</h3>
                <p><strong>Passo 1:</strong> Clone o repositório do misp-docker. Para isso, execute o seguinte comando no seu terminal:</p>
                <pre><code>git clone https://github.com/MISP/misp-docker/ && cd docker-misp</code></pre>
                <p><strong>Passo 2:</strong> Copiar o arquivo de ambiente e remover seu prefixo temporário:</p>
                <pre><code>cp template.env .env</code></pre>
                <p><strong>Passo 3:</strong> Dentro do diretório criado, verifique se o arquivo <code>docker-compose.yml</code> foi baixado corretamente. Se positivo, você precisará extrair as imagens pré-construídas ou construir novas imagens, sendo a segunda opção mais recomendada. Para extrair as imagens pré-construídas:</p>
                <pre><code>docker compose pull</code></pre>
                <p>Para construir novas imagens:</p>
                <pre><code>docker compose build</code></pre>
                <p>AVISO: O processo de geração das imagens pode demorar um pouco. Aguarde até o término para seguir para o próximo passo. Em caso de erros, consulte a seção Troubleshooting disponível no repositório indicado nas referências deste tutorial.</p>
                <p><strong>Passo 4:</strong> Agora será necessário carregar os containers, responsáveis por habilitar os componentes necessários (misp, misp-modules, redis, database e mail) para a execução do MISP.</p>
                <pre><code>docker compose up</code></pre>
                <p><strong>Passo 5:</strong> Acesse a interface web do MISP em <a href="https://localhost" target="_blank">https://localhost</a> usando as credenciais:</p>
                <ul>
                    <li>E-mail: <code>admin@admin.test</code></li>
                    <li>Senha: <code>admin</code></li>
                </ul>
            </div>
        
            <h3>Configuração da Instância do MISP Threat Sharing (MISP)</h3>
            <p>Após a instalação do MISP, será necessário realizar algumas configurações, como troca de senha, criação de organização e novos usuários.</p>
            <p>Para alterar a senha do usuário padrão, clique em <strong>Administration » List Users</strong>, depois <em>Set password</em>. Após inserir a nova senha, confirme a senha atual (<code>admin</code>) e envie as alterações.</p>
            <p>Para criar uma nova organização, clique em <strong>Administration » Add Organisations</strong> e preencha os campos com nome, UUID, descrição, nacionalidade, setor e outras informações relevantes sobre sua organização.</p>
            <p>Para criar um novo usuário, clique em <strong>Administration » Add User</strong> e preencha os campos com nome, e-mail, senha, função e organização, além de outras informações pertinentes ao novo usuário da sua organização.</p>
        
            <h3>Instalação do PyMISP</h3>
            <p>PyMISP é uma biblioteca desenvolvida em Python que facilita a interação com a plataforma MISP por meio de sua API REST. Com o PyMISP, é possível realizar operações como buscar eventos, inserir ou modificar eventos e atributos, adicionar ou atualizar amostras, além de realizar pesquisas de atributos. Para instalar a biblioteca, siga os passos abaixo:</p>
            <p><strong>Passo 1:</strong> Instale as dependências obrigatórias:</p>
            <pre><code>pip3 install pymisp</code></pre>
            <p><strong>Passo 2:</strong> Acesse o diretório em <a href="https://github.com/MISP/PyMISP/tree/main/examples" target="_blank">https://github.com/MISP/PyMISP/tree/main/examples</a></p>
            <p>Altere o <code>keys.py.sample</code> para inserir sua URL MISP e chave de API:</p>
            <pre><code>cd examples
        cp keys.py.sample keys.py
        vim keys.py</code></pre>
            
            <h3>Scripts de exportação e importação de dados</h3>
            <p>Para exportar IPs comprometidos da sua instância MISP no formato de regra para o Suricata, execute o script <code>export_suricata</code>:</p>
            <pre><code>sh export_suricata</code></pre>
            <p>Para exportar indicadores de comprometimento de um determinado evento no formato CSV, execute o script <code>export_csv</code> com o seguinte comando:</p>
            <pre><code>python3 export_csv -e -f</code></pre>
            <p>O script <code>importCauma.py</code> realiza uma importação básica de dados em uma instância MISP. No exemplo abaixo, inserimos URLs maliciosas coletadas do Catálogo de URLs Maliciosas (<a href="https://cauma.pop-ba.rnp.br/" target="_blank">https://cauma.pop-ba.rnp.br/</a>). Para executar o script, utilize o comando:</p>
            <pre><code>python3 importCauma.py</code></pre>
        
            <h3>Referências</h3>
            <ul>
                <li><a href="https://github.com/MISP/PyMISP" target="_blank">PyMisp</a></li>
                <li><a href="https://www.misp-project.org/documentation/" target="_blank">Documentação do MISP</a></li>
                <li><a href="https://github.com/misp/misp-docker" target="_blank">Repositório MISP-Docker</a></li>
            </ul>
        </section>
    </div>