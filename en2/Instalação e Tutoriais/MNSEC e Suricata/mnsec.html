<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kytos Installation Tutorial</title>
    <link rel="stylesheet" href="mnsec.css">
</head>
<body>

    <header>
        <div class="logo-group">
            <div class="logo">
                <img src="imagens/logo.PNG" alt="HackInSDN Logo">
            </div>
        </div>
        <nav>
            <ul>
                <li><a href="../../Index/index.html">Home</a></li>
                <li><a href="../../Tela_Sobre/sobre.html">About Us</a></li>
                <li><a href="../../Instalação e Tutoriais/tutorial.html">Tutorials</a></li>
                <li><a href="../../Blog/blog.html">Publications</a></li>
                <li><a href="../../https://dashboard.hackinsdn.ufba.br/login/" target="_blank">Portal</a></li>
            </ul>
        </nav>
    </header>

    <div class="container">

        <section class="tutorial-content">
            <h1>Execution and Attack Detection using MnSec and Suricata</h1>
            <h2>Brute Force</h2>
            <p>There are several authentication techniques that can be used in Brute Force attacks:</p>
            <ul>
                <li>SSH: LOGIN (default), PLAIN, CRAM-MD5, DIGEST-MD5, NTLM</li>
                <li>Additionally, TLS encryption via STARTTLS can be applied with the TLS option. Example: <code>smtp://target/TLS:PLAIN</code>; Reference.</li>
                <li>IMAP: CLEAR or APOP (default), LOGIN, PLAIN, CRAM-MD5, CRAM-SHA1, CRAM-SHA256, DIGEST-MD5, NTLM. Also supports TLS as: <code>imap://target/TLS:PLAIN</code>; Reference.</li>
                <li>POP3: CLEAR (default), LOGIN, PLAIN, CRAM-MD5, CRAM-SHA1, CRAM-SHA256, DIGEST-MD5, NTLM. Also supports TLS as: <code>pop3://target/TLS:PLAIN</code>; Reference.</li>
            </ul>
            <p>In the documented use of Mininet-sec, the main authentication technique used was LOGIN. The Python Honeypots package, which is being used in the Mininet-sec project, only supports the PLAIN authentication technique and returns a successful execution message, which can be problematic since one of the goals of using honeypots is to deceive the attacker and keep them executing commands to better analyze the attack process. Some solutions to this problem, such as modifying the Honeypots package, can be applied in future versions of Mininet-sec.</p>
        
            <h2>IMAP</h2>
            <p>Command executed in the directory containing the password and login list:</p>
            <pre><code>sudo mnsecx o1 hydra -L top-usernames-shortlist.txt -P top-usernames-shortlist.txt imap://192.168.1.103/LOGIN -V -I -F</code></pre>
            <p>Rules that generated alerts:</p>
            <pre><code>alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:”ET SCAN Rapid IMAP Connections - Possible Brute Force Attack”; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 60; classtype:misc-activity; sid:2002994; rev:7; metadata:created_at 2010_07_30, updated_at 2019_07_26;)</code></pre>
            <pre><code>alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg: “Possible IMAP Brute Force attack”; flags:S; flow: to_server; threshold: type limit, track by_src, count 20, seconds 40; tcp.mss:1460; dsize:0; window:42340; classtype: credential-theft; sid: 100000137; rev:1;) (self-authored)</code></pre>
        
            <h2>SSH</h2>
            <p>Command executed in the directory containing the password and login list:</p>
            <pre><code>sudo mnsecx o1 hydra -L top-usernames-shortlist.txt -P top-usernames-shortlist.txt ssh://192.168.1.103/LOGIN -V -I -F</code></pre>
            <p>Rule that generated alerts:</p>
            <pre><code>alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:”ET SCAN Potential SSH Scan”; flow:to_server; flags:S,12; threshold: type both, track by_src, count 5, seconds 120; reference:url,en.wikipedia.org/wiki/Brute_force_attack; classtype:attempted-recon; sid:2001219; rev:20; metadata:created_at 2010_07_30, updated_at 2019_07_26;)</code></pre>
        
            <h2>POP3</h2>
            <p>Command executed in the directory containing the password and login list:</p>
            <pre><code>sudo mnsecx o1 hydra -L top-usernames-shortlist.txt -P top-usernames-shortlist.txt pop3://192.168.1.103/LOGIN -V -I -F</code></pre>
            <p>Rule that generated alerts:</p>
            <pre><code>alert tcp $EXTERNAL_NET any -> $HOME_NET 110 (msg: “Possible POP3 Brute Force attack”; flags:S; flow: to_server; threshold: type threshold, track by_src, count 5, seconds 20; classtype: credential-theft; sid: 100000138; rev:1;) (self-authored)</code></pre>
        
            <h2>TCP, UDP and ICMP Flood</h2>
            <p><code>--rand-source</code> is an Hping3 attack parameter that promotes the use of multiple IP addresses to execute floods. In this sense, all ICMP, UDP, and TCP flood attacks triggered ET DROP rules. These rules are based on the detection of activities related to IP addresses known for their association with flood attacks.</p>
        
            <h2>Single IP Attacks</h2>
            <p>Usage example (Executed in mnsec shell):</p>
            <pre><code><mnsec-host> hping3 <protocol-or-tcp-flag> --flood -p <port-number> <ip-address></code></pre>
            <pre><code>o1 hping3 --icmp/--udp --flood --rand-source -p 567 --data 10 192.168.1.103 (h3 host ip address)</code></pre>
            <pre><code>o1 hping3 -S/-P/-U/-A/-F --flood --rand-source -p 567 --data 10 192.168.1.103 (h3 host ip address)</code></pre>
        
            <h2>TCP Flood</h2>
            <p>Using ports unrelated to any specific function on the internet:</p>
            <pre><code>alert tcp any 4444 -> any any (msg:”POSSBL SCAN M-SPLOIT R.SHELL TCP”; classtype:trojan-activity; sid:1000013; priority:1; rev:1;)</code></pre>
        
            <h2>SSH Port</h2>
            <p>Rule that generated alerts:</p>
            <pre><code>alert tcp $EXTERNAL_NET any -> $HOME_NET 22 (msg:”ET SCAN Potential SSH Scan”; flow:to_server; flags:S,12; threshold: type both, track by_src, count 5, seconds 120; reference:url,en.wikipedia.org/wiki/Brute_force_attack; classtype:attempted-recon; sid:2001219; rev:20; metadata:created_at 2010_07_30, updated_at 2019_07_26;)</code></pre>
        
            <h2>POP3 Ports</h2>
            <p>Rule that generated alerts:</p>
            <pre><code>alert tcp $EXTERNAL_NET any -> $HOME_NET 110 (msg: “Possible POP3 Brute Force attack”; flags:S; flow: to_server; threshold: type limit, track by_src, count 5, seconds 20; classtype: credential-theft; sid: 100000138; rev:1;) (self-authored)</code></pre>
            <pre><code>alert tcp $EXTERNAL_NET any -> $HOME_NET 110 (msg:”ET SCAN Rapid POP3 Connections - Possible Brute Force Attack”; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 120; classtype:misc-activity; sid:2002992; rev:7; metadata:created_at 2010_07_30, updated_at 2019_07_26;)</code></pre>
        
            <h2>IMAP Flood</h2>
            <p>Rules that generated alerts:</p>
            <pre><code>alert tcp $EXTERNAL_NET any -> $HOME_NET 143 (msg:”ET SCAN Rapid IMAP Connections - Possible Brute Force Attack”; flow:to_server; flags: S,12; threshold: type both, track by_src, count 30, seconds 60; classtype:misc-activity; sid:2002994; rev:7; metadata:created_at 2010_07_30, updated_at 2019_07_26;)</code></pre>
        
            <h2>UDP Flood</h2>
            <p>Rule that generated alerts:</p>
            <pre><code>alert udp any 4444 -> any any (msg:”POSSBL SCAN M-SPLOIT R.SHELL UDP”; classtype:trojan-activity; sid:1000014; priority:1; rev:1;)</code></pre>
        
            <h2>ICMP Flood</h2>
            <p>Not detected by any rule, and difficulties related to detecting ICMP Floods can be justified by the challenge of differentiating legitimate ICMP traffic from malicious traffic.</p>
        
            <h2>Fragmentation</h2>
            <p>Packet fragmentation in traffic can occur, for example, in the following ways: Sending traffic where packets have a data size larger than the target computer's MTU; Sending packets with a data size smaller or equal to the target computer's MTU but using techniques to promote fragmentation; Reducing the computer's MTU. Flood attacks with packet fragmentation were not detected by Suricata, and there are difficulties in creating rules in this regard due to the challenge of obtaining information about the traffic related to this type of attack. Additionally, reassembling packets for analysis is resource and time-consuming, increasing the complexity of investigating these attacks.</p>
            <p>Conclusion: Overall, Suricata performed well in detecting the promoted attacks, and it was also possible to create new rules for cases where detection was not happening, and the custom rules also performed well. As some rules are based on packet characteristics related to the traffic for which we want to create alerts, some rules were triggered for both Brute Force and Flood attacks related to the SSH, IMAP, and POP3 protocols. Suricata rules for Possible Scan M-Sploit R.Shell TCP/UDP were only triggered for Flood attacks. These rules detect attempts to exploit the network to detect vulnerabilities to implement a remote shell, meaning it is an attack related to attempts to gain access to the remote shell on a target computer.</p>
        </section>

    </div>
</body>
</html>
